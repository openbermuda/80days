<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Django Rest API code generation with cog | Around the world in 80 days</title>

    
            <link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">

      <link rel="canonical" href="http://swfiua.github.io/80days/posts/django-rest-api-code-generation-with-cog.html">



    
        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    


    

    <meta name="author" content="Johnny Gill">
        <link rel="prev" href="the-music-from-uncle.html" title="The Music from UNCLE" type="text/html">
        <link rel="next" href="dancing-in-the-dark.html" title="Dancing in the dark" type="text/html">
    
    <meta property="og:site_name" content="Around the world in 80 days">
    <meta property="og:title" content="Django Rest API code generation with cog">
    <meta property="og:url" content="http://swfiua.github.io/80days/posts/django-rest-api-code-generation-with-cog.html">
    <meta property="og:description" content="After a good break for the holidays, a couple of weeks in the
frozen wastes of Canada complete with arriving home with a stinking
cold I am now at the, &quot;this code won't write itself&quot; part of the 80 da">
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2015-01-14T21:12:36+00:00">
           <meta property="article:tag" content="django python">

    

    



</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://swfiua.github.io/80days/">

                <span id="blog-title">Around the world in 80 days</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../archive.html">Archives</a>
                </li>
<li>
<a href="../categories/index.html">Tags</a>
                </li>
<li>
<a href="../rss.xml">RSS feed</a>

                
            </li>
</ul>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="django-rest-api-code-generation-with-cog.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav>

<!-- End of Menubar -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Django Rest API code generation with cog</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Johnny Gill</span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2015-01-14T21:12:36+00:00" itemprop="datePublished" title="2015-01-14 21:12">2015-01-14 21:12</time></a></p>
                <p class="commentline">
        
    <a href="django-rest-api-code-generation-with-cog.html#disqus_thread" data-disqus-identifier="cache/posts/django-rest-api-code-generation-with-cog.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="django-rest-api-code-generation-with-cog.rst" id="sourcelink">Source</a></p>

        </div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>After a good break for the holidays, a couple of weeks in the
frozen wastes of Canada complete with arriving home with a stinking
cold I am now at the, <em>"this code won't write itself"</em> part of the 80 days
project.</p>
<p>There is quite a bit to do, but I am still finding distractions to
spend time on.</p>
<p>I have been using <a class="reference external" href="http://www.django-rest-framework.org/">django rest framework</a> to create a REST api for
the project.</p>
<p>Creating serializers, api classes and url specs for these frameworks
is largely a matter of generating standard boiler plate code.  This is
the sort of stuff I hate doing: tedious and error prone.</p>
<p>I originally wrote my own noddy code generator to help with some of
this, but was less than satisfied with the result: it was fine for my
immediate needs, but as I add more models to the application I would
need to do more autogeneration.  I had the inescapable feeling that my
code generator was probably more trouble than it was worth.  At the
same time, writing code like this by hand is deeply unsatisfying.</p>
<p>So, just when it was looking like I would have to start learning
<a class="reference external" href="https://angularjs.org/">angular.js</a> and build the front end, Ned Batchelder came to the
rescue on Twitter by <a class="reference external" href="https://twitter.com/swfiua/status/554742651082539010">posting</a> a link to a new release of <a class="reference external" href="http://nedbatchelder.com/code/cog/">cog</a>.</p>
<p>Ned described it as "a small tool that does a small job well".</p>
<p>Sure enough, it does.  It lets you embed python code (disguised as
comments) within your code to do the code generation.</p>
<p>There are a few features in <em>cog</em> that appealed to me:</p>
<ul class="simple">
<li>the code generator can be run in a way that over-writes the input
file with the newly generated code</li>
<li>it calculates checksums for the generated code and embeds them in
the output.  This is useful as it allows it to spot if you have
edited the code since it was generated and hence refuse to
re-generate that code.</li>
<li>you can re-run and it will update the existing code, assuming the
checksums have not changed.</li>
</ul>
<p>Armed with cog, I came up with <a class="reference external" href="https://github.com/swfiua/django_eighty_days/blob/master/django_eighty_days/codegen.py">codegen.py</a> to generate the boring
bits of <a class="reference external" href="https://github.com/swfiua/django_eighty_days/blob/master/django_eighty_days/api.py">api.py</a> as well as <em>urls.py</em> and <em>serializers.py</em>.</p>
<p>I am quite happy with the results.  Doug Hellmann had suggested maybe
<a class="reference external" href="https://cookiecutter.readthedocs.org/en/latest/">cookiecutter</a> might be a better solution to this problem.  In my
case, I am using cookiecutter to get the base files for my django
application, but this code generation cannot take place until you add
some models, hence the need for cog.</p>
<p>Better still would be to combine the two and add codegen.py and
suitable urls.py, serializers.py and api.py to the cookiecutter
template.  I'll add that to the list of things to do, if only to delay
the learning of <a class="reference external" href="https://angularjs.org/">angular.js</a> ;)</p>
<!-- title: links -->
<!-- slug: references -->
<!-- date: 2014-11-13 14:08:31 UTC -->
<!-- tags: -->
<!-- link: -->
<!-- description: links to include in all posts -->
<!-- type: text -->
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    
        <ul itemprop="keywords" class="tags">
           <li><a class="tag p-category" href="../categories/django-python.html" rel="tag">django python</a></li>
        </ul>

    
        <ul class="pager">
            <li class="previous">
                <a href="the-music-from-uncle.html" rel="prev" title="The Music from UNCLE">Previous post</a>
            </li>
            <li class="next">
                <a href="dancing-in-the-dark.html" rel="next" title="Dancing in the dark">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="eightydays",
            disqus_url="http://swfiua.github.io/80days/posts/django-rest-api-code-generation-with-cog.html",
        disqus_title="Django Rest API code generation with cog",
        disqus_identifier="cache/posts/django-rest-api-code-generation-with-cog.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    

</article>

        
       <script>var disqus_shortname="eightydays";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents © 2015         <a href="mailto:swfiua@gmail.com">Johnny Gill</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>

            
        </footer>
    </div>
</div>


            <script src="../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference,!.islink").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    <!-- fancy dates -->
    <script>
    moment.locale("");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script>
    <!-- end fancy dates -->
    


</body>
</html>
